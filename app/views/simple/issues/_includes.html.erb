<%= stylesheet_link_tag 'redmine_simple', :plugin => 'redmine_simple' %>
<%= stylesheet_link_tag 'select2', :plugin => 'redmine_simple' %>
<%= javascript_include_tag 'simplify_assignee', :plugin => 'redmine_simple' %>
<%= javascript_include_tag 'simplify_watchers', :plugin => 'redmine_simple' %>
<%= javascript_include_tag 'simplify_links', :plugin => 'redmine_simple' %>
<%= javascript_include_tag 'select2/select2', :plugin => 'redmine_simple' %>
<%=
    locale_url = find_select2_js_locale(current_language)
    javascript_include_tag locale_url, :plugin => 'redmine_simple' if locale_url.present?
%>

<%= javascript_tag "simplifyAssignee('#{escape_javascript autocomplete_project_assignees_path(@project)}')" %>
<%= javascript_tag "simplifyWatchers('#{escape_javascript autocomplete_project_watchers_path(@project)}')" %>

<% if User.current.allowed_to? :manage_members, @project %>
  <%= javascript_tag do %>
  function showNewMemberModal(attrs) {
    $("#ajax-modal").html('<%= escape_javascript(render 'simple/issues/new_member', :project => @project) %>');
    $('#membership_user_ids').val(attrs.memberId);
    $("#new-member-candidate").text(attrs.memberName);
    $("#member-add-cancel").on("click", attrs.cancel);
    $('input[name="membership[role_ids][]"]').on('change', function() {
      $('#member-add-submit').attr('disabled',
          $('input[name="membership[role_ids][]"]:checked').length < 1);
    });
    $('input[name="membership[role_ids][]"]:first').trigger('change');
    if (attrs.success) {
      $("#new-member-form").bind('ajax:success', function() {
        attrs.success.call();
      });
    }
    showModal("ajax-modal", "400px");
    $("#ajax-modal").addClass("new-member");
  }
  <% end %>
<% end %>
